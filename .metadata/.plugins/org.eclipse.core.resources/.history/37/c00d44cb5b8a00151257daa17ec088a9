import xlrd

def compare_spreadsheet(path, file, template):
    file_to_test = path + file
    template_to_use = template
    #  TESTs IF FILE EXISTS
    
    xl_file = xlrd.open_workbook(file_to_test)
    xl_file_sheet = xl_file.sheet_by_index(0)
    xl_file_columns = xl_file_sheet.ncols
    
    xl_template = xlrd.open_workbook(template_to_use)
    xl_template_sheet = xl_template.sheet_by_index(0)
    xl_template_columns = xl_template_sheet.ncols
    
    if (xl_file_columns == xl_template_columns):
        print("OK    - Column numbers for " + file+ " matches template!")
    else:
        print("ERROR - Column numbers for " + file + " does not match " + "template! File = " + str(xl_file_columns) + ", TEMPLATE = " + str(xl_template_columns))
        
def file_count():
    print("This will count files and make sure they match!")
 
def spreadsheets_to_qc():
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","AbsentAwaitingSeeking.xls", "data_files/templates/TEMPLATE_AbsentAwaitingSeeking.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","AdvisoryCommittees.xls", "data_files/templates/TEMPLATE_AdvisoryCommittees.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","AlphabeticIndex.xls", "data_files/templates/TEMPLATE_AlphabeticIndex.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","CardinalBishopPrefectApostolic.xls", "data_files/templates/TEMPLATE_CardinalBishopPrefectApostolic.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","DeceasedJesuits.xls", "data_files/templates/TEMPLATE_DeceasedJesuits.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","DepartedSociety.xls", "data_files/templates/TEMPLATE_DepartedSociety.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","FormationStatus.xls", "data_files/templates/TEMPLATE_FormationStatus.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","IndexofHouses_CDT.xls", "data_files/templates/TEMPLATE_IndexofHouses.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","IndexofHouses_CFN.xls", "data_files/templates/TEMPLATE_IndexofHouses.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","IndexofHouses_MAR.xls", "data_files/templates/TEMPLATE_IndexofHouses.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","IndexofHouses_ORE.xls", "data_files/templates/TEMPLATE_IndexofHouses.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","IndexofHouses_UCS.xls", "data_files/templates/TEMPLATE_IndexofHouses.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","IndexofHouses_UNE.xls", "data_files/templates/TEMPLATE_IndexofHouses.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","IndexofHouses_USA.xls", "data_files/templates/TEMPLATE_IndexofHouses.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","IndexofHouses_WIS.xls", "data_files/templates/TEMPLATE_IndexofHouses.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","Jubiliarians.xls", "data_files/templates/TEMPLATE_Jubilarians.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","MiniCatalog - GPSStreet 2016_CDT.xls", "data_files/templates/TEMPLATE_MiniCatalog - GPSStreet 2016.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","MiniCatalog - GPSStreet 2016_CFN.xls", "data_files/templates/TEMPLATE_MiniCatalog - GPSStreet 2016.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","MiniCatalog - GPSStreet 2016_MAR.xls", "data_files/templates/TEMPLATE_MiniCatalog - GPSStreet 2016.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","MiniCatalog - GPSStreet 2016_ORE.xls", "data_files/templates/TEMPLATE_MiniCatalog - GPSStreet 2016.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","MiniCatalog - GPSStreet 2016_UCS.xls", "data_files/templates/TEMPLATE_MiniCatalog - GPSStreet 2016.xls")    
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","MiniCatalog - GPSStreet 2016_UNE.xls", "data_files/templates/TEMPLATE_MiniCatalog - GPSStreet 2016.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","MiniCatalog - GPSStreet 2016_USA.xls", "data_files/templates/TEMPLATE_MiniCatalog - GPSStreet 2016.xls")
    compare_spreadsheet("data_files/sample-reports-NOSENSITIVEINFO/","MiniCatalog - GPSStreet 2016_WIS.xls", "data_files/templates/TEMPLATE_MiniCatalog - GPSStreet 2016.xls")